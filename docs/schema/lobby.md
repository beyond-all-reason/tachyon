<!-- THIS FILE IS AUTOMATICALLY GENERATED, PLEASE DO NOT EDIT IT MANUALLY -->

# Lobby

# Lobby

A lobby is a place where players can chat and setup a game before going into it.
A player can only be in at most one lobby at a time.

[lobby/create](#create) is used to create and join a lobby. Creating a lobby also
implicitely joins it.
Other players can get the list of lobbies through [lobby/subscribeList](#subscribeList). After being
subscribed they receive [lobby/listUpdated](#listUpdated) events. This allow clients
to maintain a list of lobbies on their side.


For other player to join a lobby, they need the lobby ID with [lobby/join](#join),
this operation is idempotent. Attempting to join a different lobby while being
in a lobby will fail with `invalid_request`.
Upon joining, clients receive the full state of the lobby as
response and will automatically get [lobby/updated](#updated) events when
something changes. The updated events follow json merge patch [RFC 7386](https://www.rfc-editor.org/rfc/rfc7386.html)
structure. As such, arrays like teams are represented using objects, where the items
are ordered based on their keys.
For example:

```json
{
    "teams": {
        "01": {"maxPlayers": 1},
        "02": {"maxPlayers": 2}
    }
}
```
is the representation of
```json
{
    "teams": [{"maxPlayers": 1}, {"maxPlayers": 2}]
}
```

Removing the first team can be represented by the following patch objects (they are equivalent):

```json
{
    "teams": {
        "01": {"maxPlayers": 2},
        "02": null
    }
}

{
    "teams": {
        "01": null
    }
}
```

A player can use [lobby/leave](#leave) to leave the lobby, but can also be forcibly removed
from a lobby, in which case they would receive [lobby/left](#left) event. This can
happen when the player is kicked, or if the lobby crashed. In this case, the client should
consider no longer in the lobby. This event is only sent to the player that was removed.
It will not be sent when the client leave using [lobby/leave](#leave).

---
- [create](#create)
- [join](#join)
- [leave](#leave)
- [left](#left)
- [listUpdated](#listupdated)
- [startBattle](#startbattle)
- [subscribeList](#subscribelist)
- [unsubscribeList](#unsubscribelist)
- [updated](#updated)
---

## Create

Create a lobby

- Endpoint Type: **Request** -> **Response**
- Source: **User**
- Target: **Server**
- Required Scopes: `tachyon.lobby`

### Request

<details>
<summary>JSONSchema</summary>

```json
{
    "title": "LobbyCreateRequest",
    "tachyon": {
        "source": "user",
        "target": "server",
        "scopes": ["tachyon.lobby"]
    },
    "type": "object",
    "properties": {
        "type": { "const": "request" },
        "messageId": { "type": "string" },
        "commandId": { "const": "lobby/create" },
        "data": {
            "title": "LobbyCreateRequestData",
            "type": "object",
            "properties": {
                "name": { "type": "string" },
                "mapName": { "type": "string" },
                "allyTeamConfig": {
                    "description": "each object describes an ally team",
                    "type": "array",
                    "items": {
                        "description": "config for this ally team",
                        "type": "object",
                        "properties": {
                            "maxTeams": { "type": "integer", "minimum": 1 },
                            "startBox": { "$ref": "#/definitions/startBox" },
                            "teams": {
                                "type": "array",
                                "items": {
                                    "type": "object",
                                    "properties": {
                                        "maxPlayers": {
                                            "type": "integer",
                                            "minimum": 1
                                        }
                                    },
                                    "required": ["maxPlayers"]
                                }
                            }
                        },
                        "required": ["maxTeams", "startBox", "teams"]
                    }
                }
            },
            "required": ["name", "mapName", "allyTeamConfig"]
        }
    },
    "required": ["type", "messageId", "commandId", "data"]
}

```
</details>

<details>
<summary>Example</summary>

```json
{
    "type": "request",
    "messageId": "exercitation",
    "commandId": "lobby/create",
    "data": {
        "name": "fugiat id aute",
        "mapName": "labore consequat tempor adipisicing ullamco",
        "allyTeamConfig": []
    }
}
```
</details>

#### TypeScript Definition
```ts
export interface LobbyCreateRequest {
    type: "request";
    messageId: string;
    commandId: "lobby/create";
    data: LobbyCreateRequestData;
}
export interface LobbyCreateRequestData {
    name: string;
    mapName: string;
    allyTeamConfig: {
        maxTeams: number;
        startBox: StartBox;
        teams: {
            maxPlayers: number;
        }[];
    }[];
}
export interface StartBox {
    top: number;
    bottom: number;
    left: number;
    right: number;
}
```
### Response

<details>
<summary>JSONSchema</summary>

```json
{
    "title": "LobbyCreateResponse",
    "tachyon": {
        "source": "server",
        "target": "user",
        "scopes": ["tachyon.lobby"]
    },
    "anyOf": [
        {
            "title": "LobbyCreateOkResponse",
            "type": "object",
            "properties": {
                "type": { "const": "response" },
                "messageId": { "type": "string" },
                "commandId": { "const": "lobby/create" },
                "status": { "const": "success" },
                "data": {
                    "$ref": "#/definitions/lobbyDetails",
                    "title": "LobbyCreateOkResponseData"
                }
            },
            "required": ["type", "messageId", "commandId", "status", "data"]
        },
        {
            "title": "LobbyCreateFailResponse",
            "type": "object",
            "properties": {
                "type": { "const": "response" },
                "messageId": { "type": "string" },
                "commandId": { "const": "lobby/create" },
                "status": { "const": "failed" },
                "reason": {
                    "enum": [
                        "internal_error",
                        "unauthorized",
                        "invalid_request",
                        "command_unimplemented"
                    ]
                },
                "details": { "type": "string" }
            },
            "required": ["type", "messageId", "commandId", "status", "reason"]
        }
    ]
}

```
</details>

<details>
<summary>Example</summary>

```json
{
    "type": "response",
    "messageId": "in voluptate in",
    "commandId": "lobby/create",
    "status": "success",
    "data": {
        "id": "velit eu sunt",
        "name": "minim sint aliqua dolor reprehenderit",
        "mapName": "ut",
        "engineVersion": "qui id nisi sed",
        "gameVersion": "pariatur sunt Duis",
        "allyTeamConfig": {
            "hj2": {
                "startBox": {
                    "top": 0.054356932640075684,
                    "bottom": 0.9855321049690247,
                    "left": 0.3289511203765869,
                    "right": 0.16059565544128418
                },
                "maxTeams": 12871945,
                "teams": {
                    "P?{-}&": {
                        "maxPlayers": 98656160
                    },
                    "`y[~1<": {
                        "maxPlayers": 60614247
                    }
                }
            }
        },
        "members": {
            "{BT": {
                "type": "player",
                "id": "351",
                "allyTeam": "irure ut exercitation minim sit",
                "team": "Ut proident ex dolore aute",
                "player": "in occaecat commodo nisi deserunt"
            },
            "g*~": {
                "type": "player",
                "id": "351",
                "allyTeam": "deserunt",
                "team": "mollit officia ea",
                "player": "occaecat mollit consectetur Excepteur deserunt"
            },
            "Vt55^^F": {
                "type": "player",
                "id": "351",
                "allyTeam": "deserunt et in dolor",
                "team": "elit veniam",
                "player": "cillum aliquip"
            },
            ">": {
                "type": "player",
                "id": "351",
                "allyTeam": "quis proident amet consequat minim",
                "team": "nulla sit in",
                "player": "Duis velit eiusmod anim est"
            }
        },
        "currentBattle": {
            "startedAt": 1705432698000000
        }
    }
}
```
</details>

#### TypeScript Definition
```ts
export type UserId = string;
export type UnixTime = number;

export interface LobbyCreateOkResponse {
    type: "response";
    messageId: string;
    commandId: "lobby/create";
    status: "success";
    data: LobbyCreateOkResponseData;
}
export interface LobbyCreateOkResponseData {
    id: string;
    name: string;
    mapName: string;
    engineVersion: string;
    gameVersion: string;
    allyTeamConfig: {
        [k: string]: {
            startBox: StartBox;
            maxTeams: number;
            teams: {
                [k: string]: {
                    maxPlayers: number;
                };
            };
        };
    };
    members: {
        [k: string]: {
            type: "player";
            id: UserId;
            allyTeam: string;
            team: string;
            player: string;
        };
    };
    currentBattle?: {
        startedAt: UnixTime;
    };
}
export interface StartBox {
    top: number;
    bottom: number;
    left: number;
    right: number;
}
```
Possible Failed Reasons: `internal_error`, `unauthorized`, `invalid_request`, `command_unimplemented`

---

## Join

Join a lobby. On success, get the lobby state and will receive updated events as long as player is in lobby.

- Endpoint Type: **Request** -> **Response**
- Source: **User**
- Target: **Server**
- Required Scopes: `tachyon.lobby`

### Request

<details>
<summary>JSONSchema</summary>

```json
{
    "title": "LobbyJoinRequest",
    "tachyon": {
        "source": "user",
        "target": "server",
        "scopes": ["tachyon.lobby"]
    },
    "type": "object",
    "properties": {
        "type": { "const": "request" },
        "messageId": { "type": "string" },
        "commandId": { "const": "lobby/join" },
        "data": {
            "title": "LobbyJoinRequestData",
            "type": "object",
            "properties": { "id": { "type": "string" } },
            "required": ["id"]
        }
    },
    "required": ["type", "messageId", "commandId", "data"]
}

```
</details>

<details>
<summary>Example</summary>

```json
{
    "type": "request",
    "messageId": "veniam",
    "commandId": "lobby/join",
    "data": {
        "id": "est irure mollit"
    }
}
```
</details>

#### TypeScript Definition
```ts
export interface LobbyJoinRequest {
    type: "request";
    messageId: string;
    commandId: "lobby/join";
    data: LobbyJoinRequestData;
}
export interface LobbyJoinRequestData {
    id: string;
}
```
### Response

<details>
<summary>JSONSchema</summary>

```json
{
    "title": "LobbyJoinResponse",
    "tachyon": {
        "source": "server",
        "target": "user",
        "scopes": ["tachyon.lobby"]
    },
    "anyOf": [
        {
            "title": "LobbyJoinOkResponse",
            "type": "object",
            "properties": {
                "type": { "const": "response" },
                "messageId": { "type": "string" },
                "commandId": { "const": "lobby/join" },
                "status": { "const": "success" },
                "data": {
                    "$ref": "#/definitions/lobbyDetails",
                    "title": "LobbyJoinOkResponseData"
                }
            },
            "required": ["type", "messageId", "commandId", "status", "data"]
        },
        {
            "title": "LobbyJoinFailResponse",
            "type": "object",
            "properties": {
                "type": { "const": "response" },
                "messageId": { "type": "string" },
                "commandId": { "const": "lobby/join" },
                "status": { "const": "failed" },
                "reason": {
                    "enum": [
                        "lobby_full",
                        "internal_error",
                        "unauthorized",
                        "invalid_request",
                        "command_unimplemented"
                    ]
                },
                "details": { "type": "string" }
            },
            "required": ["type", "messageId", "commandId", "status", "reason"]
        }
    ]
}

```
</details>

<details>
<summary>Example</summary>

```json
{
    "type": "response",
    "messageId": "ea ullamco dolore nostrud in",
    "commandId": "lobby/join",
    "status": "success",
    "data": {
        "id": "commodo Duis dolore consequat",
        "name": "id ex occaecat exercitation",
        "mapName": "adipisicing reprehenderit ipsum",
        "engineVersion": "nisi",
        "gameVersion": "amet",
        "allyTeamConfig": {
            "W |:KuOk/x": {
                "startBox": {
                    "top": 0.369232177734375,
                    "bottom": 0.9725453853607178,
                    "left": 0.46052515506744385,
                    "right": 0.9408383369445801
                },
                "maxTeams": 19888574,
                "teams": {
                    "*1j6/#\\": {
                        "maxPlayers": 93780059
                    },
                    "|Tg": {
                        "maxPlayers": 62605191
                    },
                    "=W1": {
                        "maxPlayers": 38869948
                    },
                    "[l.kg|.?": {
                        "maxPlayers": 11333126
                    },
                    "": {
                        "maxPlayers": 85529680
                    },
                    ",!?5'c": {
                        "maxPlayers": 71038718
                    }
                }
            },
            "roho": {
                "startBox": {
                    "top": 0.7876737117767334,
                    "bottom": 0.6124547719955444,
                    "left": 0.16075611114501953,
                    "right": 0.6785145401954651
                },
                "maxTeams": 9858573,
                "teams": {
                    "p$V'o%8'": {
                        "maxPlayers": 40755708
                    },
                    "d": {
                        "maxPlayers": 95084745
                    }
                }
            },
            "u}": {
                "startBox": {
                    "top": 0.19229495525360107,
                    "bottom": 0.7104532122612,
                    "left": 0.7016656994819641,
                    "right": 0.272929310798645
                },
                "maxTeams": 91175366,
                "teams": {
                    "": {
                        "maxPlayers": 80739517
                    },
                    "_#G.{": {
                        "maxPlayers": 18993098
                    },
                    "~!PP%W": {
                        "maxPlayers": 28960121
                    }
                }
            }
        },
        "members": {
            "2b": {
                "type": "player",
                "id": "351",
                "allyTeam": "Duis tempor non ad",
                "team": "anim in",
                "player": "cupidatat"
            }
        },
        "currentBattle": {
            "startedAt": 1705432698000000
        }
    }
}
```
</details>

#### TypeScript Definition
```ts
export type UserId = string;
export type UnixTime = number;

export interface LobbyJoinOkResponse {
    type: "response";
    messageId: string;
    commandId: "lobby/join";
    status: "success";
    data: LobbyJoinOkResponseData;
}
export interface LobbyJoinOkResponseData {
    id: string;
    name: string;
    mapName: string;
    engineVersion: string;
    gameVersion: string;
    allyTeamConfig: {
        [k: string]: {
            startBox: StartBox;
            maxTeams: number;
            teams: {
                [k: string]: {
                    maxPlayers: number;
                };
            };
        };
    };
    members: {
        [k: string]: {
            type: "player";
            id: UserId;
            allyTeam: string;
            team: string;
            player: string;
        };
    };
    currentBattle?: {
        startedAt: UnixTime;
    };
}
export interface StartBox {
    top: number;
    bottom: number;
    left: number;
    right: number;
}
```
Possible Failed Reasons: `lobby_full`, `internal_error`, `unauthorized`, `invalid_request`, `command_unimplemented`

---

## Leave

Leave the lobby, also unsubscribe from any update

- Endpoint Type: **Request** -> **Response**
- Source: **User**
- Target: **Server**
- Required Scopes: `tachyon.lobby`

### Request

<details>
<summary>JSONSchema</summary>

```json
{
    "title": "LobbyLeaveRequest",
    "tachyon": {
        "source": "user",
        "target": "server",
        "scopes": ["tachyon.lobby"]
    },
    "type": "object",
    "properties": {
        "type": { "const": "request" },
        "messageId": { "type": "string" },
        "commandId": { "const": "lobby/leave" }
    },
    "required": ["type", "messageId", "commandId"]
}

```
</details>

<details>
<summary>Example</summary>

```json
{
    "type": "request",
    "messageId": "nisi exercitation",
    "commandId": "lobby/leave"
}
```
</details>

#### TypeScript Definition
```ts
export interface LobbyLeaveRequest {
    type: "request";
    messageId: string;
    commandId: "lobby/leave";
}
```
### Response

<details>
<summary>JSONSchema</summary>

```json
{
    "title": "LobbyLeaveResponse",
    "tachyon": {
        "source": "server",
        "target": "user",
        "scopes": ["tachyon.lobby"]
    },
    "anyOf": [
        {
            "title": "LobbyLeaveOkResponse",
            "type": "object",
            "properties": {
                "type": { "const": "response" },
                "messageId": { "type": "string" },
                "commandId": { "const": "lobby/leave" },
                "status": { "const": "success" }
            },
            "required": ["type", "messageId", "commandId", "status"]
        },
        {
            "title": "LobbyLeaveFailResponse",
            "type": "object",
            "properties": {
                "type": { "const": "response" },
                "messageId": { "type": "string" },
                "commandId": { "const": "lobby/leave" },
                "status": { "const": "failed" },
                "reason": {
                    "enum": [
                        "internal_error",
                        "unauthorized",
                        "invalid_request",
                        "command_unimplemented"
                    ]
                },
                "details": { "type": "string" }
            },
            "required": ["type", "messageId", "commandId", "status", "reason"]
        }
    ]
}

```
</details>

<details>
<summary>Example</summary>

```json
{
    "type": "response",
    "messageId": "ad amet est",
    "commandId": "lobby/leave",
    "status": "success"
}
```
</details>

#### TypeScript Definition
```ts
export interface LobbyLeaveOkResponse {
    type: "response";
    messageId: string;
    commandId: "lobby/leave";
    status: "success";
}
```
Possible Failed Reasons: `internal_error`, `unauthorized`, `invalid_request`, `command_unimplemented`

---

## Left

Sent by the server when the player is removed from the lobby. Can be kicked/ban or the lobby crashed

- Endpoint Type: **Event**
- Source: **Server**
- Target: **User**
- Required Scopes: `tachyon.lobby`

### Event

<details>
<summary>JSONSchema</summary>

```json
{
    "title": "LobbyLeftEvent",
    "tachyon": {
        "source": "server",
        "target": "user",
        "scopes": ["tachyon.lobby"]
    },
    "type": "object",
    "properties": {
        "type": { "const": "event" },
        "messageId": { "type": "string" },
        "commandId": { "const": "lobby/left" },
        "data": {
            "title": "LobbyLeftEventData",
            "type": "object",
            "properties": {
                "id": { "type": "string" },
                "reason": { "type": "string" }
            },
            "required": ["id", "reason"]
        }
    },
    "required": ["type", "messageId", "commandId", "data"]
}

```
</details>

<details>
<summary>Example</summary>

```json
{
    "type": "event",
    "messageId": "est",
    "commandId": "lobby/left",
    "data": {
        "id": "et pariatur proident",
        "reason": "voluptate quis consectetur"
    }
}
```
</details>

#### TypeScript Definition
```ts
export interface LobbyLeftEvent {
    type: "event";
    messageId: string;
    commandId: "lobby/left";
    data: LobbyLeftEventData;
}
export interface LobbyLeftEventData {
    id: string;
    reason: string;
}
```
---

## ListUpdated

Sent by the server whenever a lobby is added, removed or modified

- Endpoint Type: **Event**
- Source: **Server**
- Target: **User**
- Required Scopes: `tachyon.lobby`

### Event

<details>
<summary>JSONSchema</summary>

```json
{
    "title": "LobbyListUpdatedEvent",
    "tachyon": {
        "source": "server",
        "target": "user",
        "scopes": ["tachyon.lobby"]
    },
    "type": "object",
    "properties": {
        "type": { "const": "event" },
        "messageId": { "type": "string" },
        "commandId": { "const": "lobby/listUpdated" },
        "data": {
            "title": "LobbyListUpdatedEventData",
            "type": "object",
            "properties": {
                "updates": {
                    "type": "array",
                    "items": {
                        "anyOf": [
                            {
                                "description": "this lobby is no more",
                                "type": "object",
                                "properties": {
                                    "type": { "const": "removed" },
                                    "id": { "type": "string" }
                                },
                                "required": ["type", "id"]
                            },
                            {
                                "type": "object",
                                "properties": {
                                    "type": { "const": "added" },
                                    "overview": {
                                        "$ref": "#/definitions/lobbyOverview"
                                    }
                                },
                                "required": ["type", "overview"]
                            },
                            {
                                "description": "reset the list of lobby",
                                "type": "object",
                                "properties": {
                                    "type": { "const": "setList" },
                                    "overviews": {
                                        "type": "array",
                                        "items": {
                                            "$ref": "#/definitions/lobbyOverview"
                                        }
                                    }
                                },
                                "required": ["type", "overviews"]
                            },
                            {
                                "type": "object",
                                "properties": {
                                    "type": { "const": "updated" },
                                    "overview": {
                                        "type": "object",
                                        "properties": {
                                            "id": { "type": "string" },
                                            "name": { "type": "string" },
                                            "playerCount": {
                                                "type": "integer"
                                            },
                                            "maxPlayerCount": {
                                                "type": "integer"
                                            },
                                            "mapName": { "type": "string" },
                                            "engineVersion": {
                                                "type": "string"
                                            },
                                            "gameVersion": { "type": "string" },
                                            "currentBattle": {
                                                "anyOf": [
                                                    {
                                                        "type": "object",
                                                        "properties": {
                                                            "startedAt": {
                                                                "$ref": "#/definitions/unixTime"
                                                            }
                                                        },
                                                        "required": [
                                                            "startedAt"
                                                        ]
                                                    },
                                                    { "type": "null" }
                                                ]
                                            }
                                        },
                                        "required": ["id"]
                                    }
                                },
                                "required": ["type", "overview"]
                            }
                        ]
                    }
                }
            },
            "required": ["updates"]
        }
    },
    "required": ["type", "messageId", "commandId", "data"]
}

```
</details>

<details>
<summary>Example</summary>

```json
{
    "type": "event",
    "messageId": "in dolore",
    "commandId": "lobby/listUpdated",
    "data": {
        "updates": [
            {
                "type": "added",
                "overview": {
                    "id": "et fugiat mollit",
                    "name": "Excepteur dolor ut voluptate",
                    "playerCount": 5762029,
                    "maxPlayerCount": -97152877,
                    "mapName": "et est deserunt incididunt",
                    "engineVersion": "aliqua in",
                    "gameVersion": "do consequat",
                    "currentBattle": {
                        "startedAt": 1705432698000000
                    }
                }
            },
            {
                "type": "updated",
                "overview": {
                    "id": "Excepteur laborum enim"
                }
            },
            {
                "type": "setList",
                "overviews": []
            }
        ]
    }
}
```
</details>

#### TypeScript Definition
```ts
export type UnixTime = number;

export interface LobbyListUpdatedEvent {
    type: "event";
    messageId: string;
    commandId: "lobby/listUpdated";
    data: LobbyListUpdatedEventData;
}
export interface LobbyListUpdatedEventData {
    updates: (
        | {
              type: "removed";
              id: string;
          }
        | {
              type: "added";
              overview: LobbyOverview;
          }
        | {
              type: "setList";
              overviews: LobbyOverview[];
          }
        | {
              type: "updated";
              overview: {
                  id: string;
                  name?: string;
                  playerCount?: number;
                  maxPlayerCount?: number;
                  mapName?: string;
                  engineVersion?: string;
                  gameVersion?: string;
                  currentBattle?: {
                      startedAt: UnixTime;
                  } | null;
              };
          }
    )[];
}
export interface LobbyOverview {
    id: string;
    name: string;
    playerCount: number;
    maxPlayerCount: number;
    mapName: string;
    engineVersion: string;
    gameVersion: string;
    currentBattle: {
        startedAt: UnixTime;
    } | null;
}
```
---

## StartBattle

Start the battle for the lobby. If this request succeed players will receive a battle/start request.

- Endpoint Type: **Request** -> **Response**
- Source: **User**
- Target: **Server**
- Required Scopes: `tachyon.lobby`

### Request

<details>
<summary>JSONSchema</summary>

```json
{
    "title": "LobbyStartBattleRequest",
    "tachyon": {
        "source": "user",
        "target": "server",
        "scopes": ["tachyon.lobby"]
    },
    "type": "object",
    "properties": {
        "type": { "const": "request" },
        "messageId": { "type": "string" },
        "commandId": { "const": "lobby/startBattle" }
    },
    "required": ["type", "messageId", "commandId"]
}

```
</details>

<details>
<summary>Example</summary>

```json
{
    "type": "request",
    "messageId": "nisi ut ullamco sint",
    "commandId": "lobby/startBattle"
}
```
</details>

#### TypeScript Definition
```ts
export interface LobbyStartBattleRequest {
    type: "request";
    messageId: string;
    commandId: "lobby/startBattle";
}
```
### Response

<details>
<summary>JSONSchema</summary>

```json
{
    "title": "LobbyStartBattleResponse",
    "tachyon": {
        "source": "server",
        "target": "user",
        "scopes": ["tachyon.lobby"]
    },
    "anyOf": [
        {
            "title": "LobbyStartBattleOkResponse",
            "type": "object",
            "properties": {
                "type": { "const": "response" },
                "messageId": { "type": "string" },
                "commandId": { "const": "lobby/startBattle" },
                "status": { "const": "success" }
            },
            "required": ["type", "messageId", "commandId", "status"]
        },
        {
            "title": "LobbyStartBattleFailResponse",
            "type": "object",
            "properties": {
                "type": { "const": "response" },
                "messageId": { "type": "string" },
                "commandId": { "const": "lobby/startBattle" },
                "status": { "const": "failed" },
                "reason": {
                    "enum": [
                        "internal_error",
                        "unauthorized",
                        "invalid_request",
                        "command_unimplemented"
                    ]
                },
                "details": { "type": "string" }
            },
            "required": ["type", "messageId", "commandId", "status", "reason"]
        }
    ]
}

```
</details>

<details>
<summary>Example</summary>

```json
{
    "type": "response",
    "messageId": "occaecat id in do nostrud",
    "commandId": "lobby/startBattle",
    "status": "success"
}
```
</details>

#### TypeScript Definition
```ts
export interface LobbyStartBattleOkResponse {
    type: "response";
    messageId: string;
    commandId: "lobby/startBattle";
    status: "success";
}
```
Possible Failed Reasons: `internal_error`, `unauthorized`, `invalid_request`, `command_unimplemented`

---

## SubscribeList

Ask the server to send updates about lobby list. Idempotent, subscribing multiple time has no effect.

- Endpoint Type: **Request** -> **Response**
- Source: **User**
- Target: **Server**
- Required Scopes: `tachyon.lobby`

### Request

<details>
<summary>JSONSchema</summary>

```json
{
    "title": "LobbySubscribeListRequest",
    "tachyon": {
        "source": "user",
        "target": "server",
        "scopes": ["tachyon.lobby"]
    },
    "type": "object",
    "properties": {
        "type": { "const": "request" },
        "messageId": { "type": "string" },
        "commandId": { "const": "lobby/subscribeList" }
    },
    "required": ["type", "messageId", "commandId"]
}

```
</details>

<details>
<summary>Example</summary>

```json
{
    "type": "request",
    "messageId": "incididunt deserunt ullamco culpa nulla",
    "commandId": "lobby/subscribeList"
}
```
</details>

#### TypeScript Definition
```ts
export interface LobbySubscribeListRequest {
    type: "request";
    messageId: string;
    commandId: "lobby/subscribeList";
}
```
### Response

<details>
<summary>JSONSchema</summary>

```json
{
    "title": "LobbySubscribeListResponse",
    "tachyon": {
        "source": "server",
        "target": "user",
        "scopes": ["tachyon.lobby"]
    },
    "anyOf": [
        {
            "title": "LobbySubscribeListOkResponse",
            "type": "object",
            "properties": {
                "type": { "const": "response" },
                "messageId": { "type": "string" },
                "commandId": { "const": "lobby/subscribeList" },
                "status": { "const": "success" }
            },
            "required": ["type", "messageId", "commandId", "status"]
        },
        {
            "title": "LobbySubscribeListFailResponse",
            "type": "object",
            "properties": {
                "type": { "const": "response" },
                "messageId": { "type": "string" },
                "commandId": { "const": "lobby/subscribeList" },
                "status": { "const": "failed" },
                "reason": {
                    "enum": [
                        "internal_error",
                        "unauthorized",
                        "invalid_request",
                        "command_unimplemented"
                    ]
                },
                "details": { "type": "string" }
            },
            "required": ["type", "messageId", "commandId", "status", "reason"]
        }
    ]
}

```
</details>

<details>
<summary>Example</summary>

```json
{
    "type": "response",
    "messageId": "non",
    "commandId": "lobby/subscribeList",
    "status": "success"
}
```
</details>

#### TypeScript Definition
```ts
export interface LobbySubscribeListOkResponse {
    type: "response";
    messageId: string;
    commandId: "lobby/subscribeList";
    status: "success";
}
```
Possible Failed Reasons: `internal_error`, `unauthorized`, `invalid_request`, `command_unimplemented`

---

## UnsubscribeList

Ask the server to stop sending updates about lobby list. Idempotent, if not subscribed, will still succeed.

- Endpoint Type: **Request** -> **Response**
- Source: **User**
- Target: **Server**
- Required Scopes: `tachyon.lobby`

### Request

<details>
<summary>JSONSchema</summary>

```json
{
    "title": "LobbyUnsubscribeListRequest",
    "tachyon": {
        "source": "user",
        "target": "server",
        "scopes": ["tachyon.lobby"]
    },
    "type": "object",
    "properties": {
        "type": { "const": "request" },
        "messageId": { "type": "string" },
        "commandId": { "const": "lobby/unsubscribeList" }
    },
    "required": ["type", "messageId", "commandId"]
}

```
</details>

<details>
<summary>Example</summary>

```json
{
    "type": "request",
    "messageId": "Duis dolor esse",
    "commandId": "lobby/unsubscribeList"
}
```
</details>

#### TypeScript Definition
```ts
export interface LobbyUnsubscribeListRequest {
    type: "request";
    messageId: string;
    commandId: "lobby/unsubscribeList";
}
```
### Response

<details>
<summary>JSONSchema</summary>

```json
{
    "title": "LobbyUnsubscribeListResponse",
    "tachyon": {
        "source": "server",
        "target": "user",
        "scopes": ["tachyon.lobby"]
    },
    "anyOf": [
        {
            "title": "LobbyUnsubscribeListOkResponse",
            "type": "object",
            "properties": {
                "type": { "const": "response" },
                "messageId": { "type": "string" },
                "commandId": { "const": "lobby/unsubscribeList" },
                "status": { "const": "success" }
            },
            "required": ["type", "messageId", "commandId", "status"]
        },
        {
            "title": "LobbyUnsubscribeListFailResponse",
            "type": "object",
            "properties": {
                "type": { "const": "response" },
                "messageId": { "type": "string" },
                "commandId": { "const": "lobby/unsubscribeList" },
                "status": { "const": "failed" },
                "reason": {
                    "enum": [
                        "internal_error",
                        "unauthorized",
                        "invalid_request",
                        "command_unimplemented"
                    ]
                },
                "details": { "type": "string" }
            },
            "required": ["type", "messageId", "commandId", "status", "reason"]
        }
    ]
}

```
</details>

<details>
<summary>Example</summary>

```json
{
    "type": "response",
    "messageId": "reprehenderit",
    "commandId": "lobby/unsubscribeList",
    "status": "success"
}
```
</details>

#### TypeScript Definition
```ts
export interface LobbyUnsubscribeListOkResponse {
    type: "response";
    messageId: string;
    commandId: "lobby/unsubscribeList";
    status: "success";
}
```
Possible Failed Reasons: `internal_error`, `unauthorized`, `invalid_request`, `command_unimplemented`

---

## Updated

Sent by the server whenever something in the lobby changes. Uses json patch (RFC-7386)

- Endpoint Type: **Event**
- Source: **Server**
- Target: **User**
- Required Scopes: `tachyon.lobby`

### Event

<details>
<summary>JSONSchema</summary>

```json
{
    "title": "LobbyUpdatedEvent",
    "tachyon": {
        "source": "server",
        "target": "user",
        "scopes": ["tachyon.lobby"]
    },
    "type": "object",
    "properties": {
        "type": { "const": "event" },
        "messageId": { "type": "string" },
        "commandId": { "const": "lobby/updated" },
        "data": {
            "title": "LobbyUpdatedEventData",
            "type": "object",
            "properties": {
                "id": { "type": "string" },
                "name": { "type": "string" },
                "mapName": { "type": "string" },
                "engineVersion": { "type": "string" },
                "gameVersion": { "type": "string" },
                "allyTeams": {
                    "type": "object",
                    "patternProperties": {
                        "^(.*)$": {
                            "anyOf": [
                                {
                                    "description": "this represent an array, items should be sorted lexicographically on their keys",
                                    "type": "object",
                                    "properties": {
                                        "startBox": {
                                            "$ref": "#/definitions/startBox"
                                        },
                                        "maxTeams": {
                                            "type": "integer",
                                            "minimum": 1
                                        },
                                        "teams": {
                                            "type": "object",
                                            "patternProperties": {
                                                "^(.*)$": {
                                                    "anyOf": [
                                                        {
                                                            "type": "object",
                                                            "properties": {
                                                                "maxPlayers": {
                                                                    "type": "integer",
                                                                    "minimum": 1
                                                                }
                                                            }
                                                        },
                                                        { "type": "null" }
                                                    ]
                                                }
                                            }
                                        }
                                    },
                                    "required": ["teams"]
                                },
                                { "type": "null" }
                            ]
                        }
                    }
                },
                "members": {
                    "type": "object",
                    "patternProperties": {
                        "^(.*)$": {
                            "anyOf": [
                                {
                                    "type": "object",
                                    "properties": {
                                        "type": { "const": "player" },
                                        "id": {
                                            "$ref": "#/definitions/userId"
                                        },
                                        "allyTeam": { "type": "string" },
                                        "team": { "type": "string" },
                                        "player": { "type": "string" }
                                    },
                                    "required": [
                                        "type",
                                        "id",
                                        "allyTeam",
                                        "team",
                                        "player"
                                    ]
                                },
                                { "type": "null" }
                            ]
                        }
                    }
                },
                "currentBattle": {
                    "anyOf": [
                        {
                            "description": "If a battle is currently happening, here are the info",
                            "type": "object",
                            "properties": {
                                "id": { "type": "string" },
                                "startedAt": {
                                    "$ref": "#/definitions/unixTime"
                                }
                            },
                            "required": ["id", "startedAt"]
                        },
                        { "type": "null" }
                    ]
                }
            },
            "required": ["id"]
        }
    },
    "required": ["type", "messageId", "commandId", "data"]
}

```
</details>

<details>
<summary>Example</summary>

```json
{
    "type": "event",
    "messageId": "laboris ipsum ea ut sit",
    "commandId": "lobby/updated",
    "data": {
        "id": "nulla occaecat adipisicing in",
        "name": "in mollit qui consectetur",
        "mapName": "incididunt id",
        "gameVersion": "nostrud laborum deserunt",
        "allyTeams": {
            "Kl+": null,
            "rc": null
        },
        "members": {
            "(:&D": {
                "type": "player",
                "id": "351",
                "allyTeam": "voluptate dolore sed esse",
                "team": "Ut anim Duis proident",
                "player": "dolor"
            },
            "XjKt": null
        },
        "currentBattle": {
            "id": "ipsum consequat adipisicing quis eu",
            "startedAt": 1705432698000000
        }
    }
}
```
</details>

#### TypeScript Definition
```ts
export type UserId = string;
export type UnixTime = number;

export interface LobbyUpdatedEvent {
    type: "event";
    messageId: string;
    commandId: "lobby/updated";
    data: LobbyUpdatedEventData;
}
export interface LobbyUpdatedEventData {
    id: string;
    name?: string;
    mapName?: string;
    engineVersion?: string;
    gameVersion?: string;
    allyTeams?: {
        [k: string]: {
            startBox?: StartBox;
            maxTeams?: number;
            teams: {
                [k: string]: {
                    maxPlayers?: number;
                } | null;
            };
        } | null;
    };
    members?: {
        [k: string]: {
            type: "player";
            id: UserId;
            allyTeam: string;
            team: string;
            player: string;
        } | null;
    };
    currentBattle?: {
        id: string;
        startedAt: UnixTime;
    } | null;
}
export interface StartBox {
    top: number;
    bottom: number;
    left: number;
    right: number;
}
```
